TIMEINST:
LOCAL Q%(227),B$(4),A%,B%,L%
REM Q% is here to make sure poking does not corrupt object code
CLS
PRINT "Loading...";

L%=$1C8

REM Make room, or deactivate existing copy.
A%=PEEKW($2065)
IF A%=-32768
 A%=32767
ENDIF
IF PEEKW(A%)=$4D52
 B%=A%
 WHILE PEEKW(B%)=$4D52 AND PEEKW(B%+2)<>$546D
  B%=B%+PEEKW(B%+4)
 ENDWH
 IF PEEKW(B%)=$4D52
  A%=B%
  IF PEEKW($205C)>0
   USR(A%+8,0)
  ENDIF
  GOTO INST::
 ENDIF
ENDIF

REM Lower Ramtop
A%=A%-L%
POKEW $2065,A%

INST::

REM Install
B$=HEX$(A%+$1C6)
B%=A%
B%=POKCNV%:(B%,"4D52546D01C82014FE"+B$+"270E8D21250AFC"+B$+"ED054F5FFD"+B$+"39FE"+B$+"260E8D0D250AEC05FD"+B$+"CC"+HEX$($58+A%)+"ED0539FE2002E6000D271FC104261437EC01188C5449182609EC03188C4D4518270633CB033A20DE330C39CE21883F6ABD")
B%=POKCNV%:(B%,HEX$($13A+A%)+"72015B1A3F4B27023F482606965B26F320E65A27E25A26EBBD"+HEX$($7D+A%)+"20EFDC62CA803F145FD764CE"+HEX$($1AD+A%)+"3AE600D766CE"+HEX$($1B3+A%)+"3AA6009765CE"+HEX$($84+A%)+"3CCE"+HEX$($1BA+A%))
B%=POKCNV%:(B%,"F621893AA6005A2608F62188C40326014CD666C10226029765B1218A2403B7218ABD"+HEX$($13A+A%)+"CE"+HEX$($1A7+A%)+"D6663AA600C1022607F6218AC0098900D6633F143F485A271BC10C2629C606D742CE2188CC20C572015B7D005B26FB7F00413F6DDC62C47F3F1438394A")
B%=POKCNV%:(B%,"26975CC10625015F3917CE2188D6663AD6644A4A260BA6006C00916525026F00394A260C6D0027036A00399665A700394A26CC5A2A02C60539CE2188EC043736A603364FE600C307C03736E601CE"+HEX$($183+A%)+"3A3A3A8603363CCE2188A6024C368603")
B%=POKCNV%:(B%,"363F693C3F6F0B2562202D203276202562202534752535667D3A7D3A7D25346600394A414E4645424D41524150524D41594A554E4A554C4155475345504F43544E4F564445430B070414171A020100030405630B00173B3B221E1B1E1D1E1D1E1E1D1E1D1E0000")

REM Activate
USR(A%+6,0)
CLS
PRINT "Time TSR loaded";
GET

REM Do not remove the STOP!  Must not disturb old language stack area.
STOP
